_ = require 'lodash'
logger = require './logger'
dbName = 'test'

MongoWatch = require 'mongo-watch'
watcher = new MongoWatch {format: 'normal'}
{Transform, Readable, Writable, Duplex} = require 'stream'

class MongoStream extends Readable
  constructor: (options={}) ->
    super {objectMode: true}

    @_buffer = []
    watcher.watch "#{dbName}.users", @push.bind(@)

  _read: (size) ->
    console.log 'requested read'

module.exports = MongoStream
